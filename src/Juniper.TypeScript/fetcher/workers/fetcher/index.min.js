var yt=Object.defineProperty;var vt=(t,e,r)=>e in t?yt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var i=(t,e,r)=>(vt(t,typeof e!="symbol"?e+"":e,r),r);function x(t){return t.splice(0)}var Q;(function(t){t[t.Linear=0]="Linear",t[t.LinearContinuous=1]="LinearContinuous",t[t.Quadratic=2]="Quadratic",t[t.QuadraticContinuous=3]="QuadraticContinuous",t[t.Sine=4]="Sine",t[t.SineContinuous=5]="SineContinuous",t[t.Bump=6]="Bump",t[t.BumpContinuous=7]="BumpContinuous",t[t.Jump=8]="Jump"})(Q||(Q={}));function P(t,e,r){return typeof t===e||t instanceof r}function g(t){return P(t,"function",Function)}function T(t){return P(t,"string",String)}function H(t){return P(t,"boolean",Boolean)}function k(t){return P(t,"number",Number)}function y(t){return t instanceof Array}function W(t,e){throw new Error((e||"Unexpected object: ")+t)}function d(t){return t==null}function h(t){return!d(t)}function wt(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Uint32Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||"BigUint64Array"in globalThis&&t instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&t instanceof globalThis.BigInt64Array}function bt(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Z(t){return T(t)||wt(t)||t instanceof Blob||t instanceof FormData||bt(t)||t instanceof ReadableStream||"Document"in globalThis&&t instanceof Document}function I(t,e){return t.splice(e,1)[0]}var Y=new WeakMap,tt=class{constructor(){i(this,"listeners",new Map);i(this,"listenerOptions",new Map);Y.set(this,this.listeners)}addEventListener(e,r,s){if(g(r)){let o=this.listeners.get(e);o||(o=new Array,this.listeners.set(e,o)),o.find(n=>n===r)||(o.push(r),s&&this.listenerOptions.set(r,s))}}removeEventListener(e,r){if(g(r)){let s=this.listeners.get(e);s&&this.removeListener(s,r)}}removeListener(e,r){let s=e.findIndex(o=>o===r);s>=0&&(I(e,s),this.listenerOptions.has(r)&&this.listenerOptions.delete(r))}dispatchEvent(e){let r=this.listeners.get(e.type);if(r)for(let s of r){let o=this.listenerOptions.get(s);h(o)&&!H(o)&&o.once&&this.removeListener(r,s),s.call(this,e)}return!e.defaultPrevented}},w=class extends Event{get type(){return super.type}constructor(e){super(e)}},b=class extends tt{constructor(){super(...arguments);i(this,"bubblers",new Set);i(this,"scopes",new WeakMap)}addBubbler(e){this.bubblers.add(e)}removeBubbler(e){this.bubblers.delete(e)}addEventListener(e,r,s){super.addEventListener(e,r,s)}removeEventListener(e,r){super.removeEventListener(e,r)}addScopedEventListener(e,r,s,o){this.scopes.has(e)||this.scopes.set(e,[]),this.scopes.get(e).push([r,s]),this.addEventListener(r,s,o)}removeScope(e){let r=this.scopes.get(e);if(r){this.scopes.delete(e);for(let[s,o]of r)this.removeEventListener(s,o)}}clearEventListeners(e){let r=Y.get(this);for(let[s,o]of r)(d(e)||e===s)&&(x(o),r.delete(s))}dispatchEvent(e){if(!super.dispatchEvent(e))return!1;for(let r of this.bubblers)if(!r.dispatchEvent(e))return!1;return!0}};function rt(t,...e){for(let r of e)if(h(r))for(let[s,o]of r)t.set(s,o);return t}var U;(function(t){t[t.LocalUser=0]="LocalUser",t[t.Mouse=1]="Mouse",t[t.Pen=2]="Pen",t[t.Touch0=3]="Touch0",t[t.Touch1=4]="Touch1",t[t.Touch2=5]="Touch2",t[t.Touch3=6]="Touch3",t[t.Touch4=7]="Touch4",t[t.Touch5=8]="Touch5",t[t.Touch6=9]="Touch6",t[t.Touch7=10]="Touch7",t[t.Touch8=11]="Touch8",t[t.Touch9=12]="Touch9",t[t.Touch10=13]="Touch10",t[t.Touches=14]="Touches",t[t.MotionController=15]="MotionController",t[t.MotionControllerLeft=16]="MotionControllerLeft",t[t.MotionControllerRight=17]="MotionControllerRight",t[t.RemoteUser=18]="RemoteUser"})(U||(U={}));var st;(function(t){t[t.Forward=1]="Forward",t[t.Stopped=0]="Stopped",t[t.Reverse=-1]="Reverse"})(st||(st={}));var ot;(function(t){t.None="",t.Left="left",t.Right="right"})(ot||(ot={}));var nt;(function(t){t.None="none",t.Entered="entered",t.EnteredDisabled="entereddisabled",t.Pressed="pressed",t.PressedDisabled="presseddisabled",t.Clicked="clicked",t.ClickedDisabled="clickeddisabled",t.DraggingStarted="draggingstarted",t.DraggingStartedDisabled="draggingstarteddisabled",t.Dragged="dragged",t.DraggingEnded="draggingended",t.Released="released",t.Exited="exited",t.Opened="opened",t.Closed="closed",t.Error="error",t.Success="success",t.StartUp="startup",t.ShutDown="shutdown",t.Scrolled="scrolled"})(nt||(nt={}));var it;(function(t){t[t.Mouse0=0]="Mouse0",t[t.Mouse1=1]="Mouse1",t[t.Mouse2=2]="Mouse2",t[t.Mouse3=3]="Mouse3",t[t.Mouse4=4]="Mouse4"})(it||(it={}));var at;(function(t){t[t.None=0]="None",t[t.Mouse0=1]="Mouse0",t[t.Mouse1=2]="Mouse1",t[t.Mouse2=4]="Mouse2",t[t.Mouse3=8]="Mouse3",t[t.Mouse4=16]="Mouse4"})(at||(at={}));var ht;(function(t){t[t.None=0]="None",t[t.Primary=1]="Primary",t[t.Secondary=2]="Secondary",t[t.Menu=3]="Menu",t[t.Info=4]="Info"})(ht||(ht={}));var Tt=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,F=navigator.userAgent.match(Tt),_=!!F,Br=_&&{major:parseFloat(F[1]),minor:parseFloat(F[2]),patch:parseFloat(F[3])},Cr=_&&/pacific/i.test(navigator.userAgent),Or=_&&/quest/i.test(navigator.userAgent),Dr=_&&/quest 2/i.test(navigator.userAgent);var Lr=!("Document"in globalThis);var kt=298.257223563,It=6378137;var $=1/kt,E=1-$,c=$/(2-$),Nr=It/(1+c)*(1+c*c/4+c*c*c*c/64),A=Math.sqrt(1-E*E),f=1-E*E,qr=A*A/(1-A*A),Hr=1-f*(.25+f*(3/64+5*f/256)),Wr=f*(3/8+f*(3/32+45*f/1024)),Ur=f*f*(15/256+f*45/1024),$r=f*f*f*(35/3072),Xr=[c/2-2*c*c/3+37*c*c*c/96,c*c/48+c*c*c/15,17*c*c*c/480],jr=[2*c-2*c*c/3,7*c*c/3-8*c*c*c/5,56*c*c*c/15];var X;(function(t){t[t.Northern=0]="Northern",t[t.Southern=1]="Southern"})(X||(X={}));var pt;(function(t){t[t.None=-1]="None",t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Down=3]="Down",t[t.Back=4]="Back",t[t.Front=5]="Front"})(pt||(pt={}));var Gs=2*Math.PI;var M=class{constructor(){i(this,"attached",new Array);i(this,"soFar",null);i(this,"total",null);i(this,"msg",null);i(this,"est",null)}report(e,r,s,o){this.soFar=e,this.total=r,this.msg=s,this.est=o;for(let n of this.attached)n.report(e,r,s,o)}attach(e){this.attached.push(e),e.report(this.soFar,this.total,this.msg,this.est)}end(){this.report(1,1,"done"),this.soFar=null,this.total=null,this.msg=null,this.est=null,x(this.attached)}};var B=class extends M{constructor(e,r){super();i(this,"i");i(this,"prog");this.i=e,this.prog=r}report(e,r,s,o){super.report(e,r,s,o),this.prog.update(this.i,e,r,s)}};var C=class{constructor(e){i(this,"prog");i(this,"weightTotal",0);i(this,"start");i(this,"subProgressCallbacks",new Array);i(this,"subProgressWeights",new Array);i(this,"subProgressValues",new Array);this.prog=e,this.start=performance.now();for(let r=0;r<this.subProgressWeights.length;++r)this.subProgressValues[r]=0,this.subProgressCallbacks[r]=new B(r,this)}addSubProgress(e){e=e||1,this.weightTotal+=e,this.subProgressWeights.push(e),this.subProgressValues.push(0);let r=new B(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(r),r}update(e,r,s,o){if(this.prog){this.subProgressValues[e]=r/s;let n=0;for(let l=0;l<this.subProgressWeights.length;++l)n+=this.subProgressValues[l]*this.subProgressWeights[l];let a=performance.now(),p=a-this.start,u=this.start-a+p*this.weightTotal/n;this.prog.report(n,this.weightTotal,o,u)}}};function R(t){return h(t)&&g(t.report)&&g(t.attach)&&g(t.end)}function ut(t){return new lt(t)}var lt=class extends C{pop(e){return this.addSubProgress(e)}};var D=class extends b{constructor(e){super();i(this,"worker");i(this,"taskCounter",0);i(this,"invocations",new Map);this.worker=e,D.isSupported||console.warn("Workers are not supported on this system."),this.worker.addEventListener("message",r=>{let s=r.data;switch(s.type){case"event":this.propogateEvent(s);break;case"progress":this.progressReport(s);break;case"return":this.methodReturned(s);break;case"error":this.invocationError(s);break;default:W(s)}})}postMessage(e,r){e.type!=="methodCall"&&W(e.type),r?this.worker.postMessage(e,r):this.worker.postMessage(e)}dispose(){this.worker.terminate()}propogateEvent(e){let r=new w(e.eventName);this.dispatchEvent(Object.assign(r,e.data))}progressReport(e){let r=this.invocations.get(e.taskID),{onProgress:s}=r;s&&s.report(e.soFar,e.total,e.msg,e.est)}methodReturned(e){let r=this.removeInvocation(e.taskID),{resolve:s}=r;s(e.returnValue)}invocationError(e){let r=this.removeInvocation(e.taskID),{reject:s,methodName:o}=r;s(new Error(`${o} failed. Reason: ${e.errorMessage}`))}removeInvocation(e){let r=this.invocations.get(e);return this.invocations.delete(e),r}callMethod(e,r,s,o){if(!D.isSupported)return Promise.reject(new Error("Workers are not supported on this system."));let n=null,a=null;R(r)&&(o=r,r=null,s=null),R(s)&&!o&&(o=s,s=null),y(r)&&(n=r),y(s)&&(a=s);let p=this.taskCounter++;return new Promise((u,l)=>{let v={onProgress:o,resolve:u,reject:l,methodName:e};this.invocations.set(p,v);let m=null;h(r)?m={type:"methodCall",taskID:p,methodName:e,params:n}:m={type:"methodCall",taskID:p,methodName:e},this.postMessage(m,a)})}},O=D;i(O,"isSupported","Worker"in globalThis);var mt=class extends b{constructor(e,r){super();i(this,"scriptPath");i(this,"taskCounter");i(this,"workers");this.scriptPath=e.scriptPath;let s=-1,o=e.workers,n=null;if(k(o)?s=o:h(o)?(this.taskCounter=o.curTaskCounter,n=o.workers,s=n.length):s=navigator.hardwareConcurrency||4,s<1)throw new Error("Worker pool size must be a postive integer greater than 0");if(this.workers=new Array(s),d(n)){this.taskCounter=0;for(let a=0;a<s;++a)this.workers[a]=new r(new Worker(this.scriptPath,{type:"module"}))}else for(let a=0;a<s;++a)this.workers[a]=new r(n[a]);for(let a of this.workers)a.addBubbler(this)}dispose(){for(let e of this.workers)e.dispose();x(this.workers)}callMethod(e,r,s,o){if(!O.isSupported)return Promise.reject(new Error("Workers are not supported on this system."));let n=null,a=null;return R(r)&&(o=r,r=null,s=null),R(s)&&!o&&(o=s,s=null),y(r)&&(n=r),y(s)&&(a=s),this.nextWorker().callMethod(e,n,a,o)}nextWorker(){let r=this.taskCounter++%this.workers.length;return this.workers[r]}};i(mt,"isSupported","Worker"in globalThis);var dt=class extends M{constructor(e,r){super();i(this,"server");i(this,"taskID");this.server=e,this.taskID=r}report(e,r,s,o){let n={type:"progress",taskID:this.taskID,soFar:e,total:r,msg:s,est:o};this.server.postMessage(n)}},j=class{constructor(e){i(this,"self");i(this,"methods",new Map);this.self=e,this.self.addEventListener("message",r=>{let s=r.data;this.callMethod(s)})}postMessage(e,r){h(r)?this.self.postMessage(e,r):this.self.postMessage(e)}callMethod(e){let r=this.methods.get(e.methodName);if(r)try{y(e.params)?r(e.taskID,...e.params):h(e.params)?r(e.taskID,e.params):r(e.taskID)}catch(s){this.onError(e.taskID,`method invocation error: ${e.methodName}(${s.message||s})`)}else this.onError(e.taskID,`method not found: ${e.methodName}`)}onError(e,r){let s={type:"error",taskID:e,errorMessage:r};this.postMessage(s)}onReturn(e,r,s){let o=null;if(r===void 0?o={type:"return",taskID:e}:o={type:"return",taskID:e,returnValue:r},h(s)){let n=s(r);this.postMessage(o,n)}else this.postMessage(o)}onEvent(e,r,s,o){let n=null;if(h(s)?n={type:"event",eventName:e,data:s(r)}:n={type:"event",eventName:e},n.data!==void 0&&h(o)){let a=o(n.data);this.postMessage(n,a)}else this.postMessage(n)}addMethodInternal(e,r,s){if(this.methods.has(e))throw new Error(`${e} method has already been mapped.`);this.methods.set(e,async(o,...n)=>{let a=new dt(this,o);try{let p=await r(...n,a);this.onReturn(o,p,s)}catch(p){console.error(p),this.onError(o,p.message||p)}})}addFunction(e,r,s){this.addMethodInternal(e,r,s)}addVoidFunction(e,r){this.addMethodInternal(e,r)}addMethod(e,r,s,o){this.addFunction(e,s.bind(r),o)}addVoidMethod(e,r,s){this.addVoidFunction(e,s.bind(r))}addEvent(e,r,s,o){e.addEventListener(r,n=>this.onEvent(r,n,s,o))}};var V=class{async translateResponse(e,r){let{status:s,content:o,contentType:n,contentLength:a,fileName:p,headers:u,date:l}=await e;return{status:s,content:await r(o),contentType:n,contentLength:a,fileName:p,headers:u,date:l}}};function G(t,e,r,s,o,n){return new Promise((a,p)=>{let u=!n;n&&n.then(()=>u=!0);let l=!1,v=o;function m(){v&&l&&a()}function N(q){return()=>{u&&p(`${q} (${e.status})`)}}r.addEventListener("loadstart",()=>{u&&!l&&s&&s.report(0,1,t)}),r.addEventListener("progress",q=>{if(u&&!l){let S=q;s&&s.report(S.loaded,Math.max(S.loaded,S.total),t),S.loaded===S.total&&(v=!0,m())}}),r.addEventListener("load",()=>{u&&!l&&(s&&s.report(1,1,t),l=!0,m())}),r.addEventListener("error",N("error")),r.addEventListener("abort",N("abort")),r.addEventListener("timeout",N("timeout"))})}function gt(t,e,r,s,o,n,a){if(t.open(r,s),t.responseType=e,t.timeout=o,n)for(let[p,u]of n)t.setRequestHeader(p,u);h(a)?t.send(a):t.send()}function L(t,e,r){if(!t.has(e))return null;let s=t.get(e);try{let o=r(s);return t.delete(e),o}catch(o){console.warn(e,o)}return null}var At=/filename=\"(.+)\"(;|$)/;function xt(t){let e=t.getAllResponseHeaders().split(/[\r\n]+/).map(o=>{let n=o.split(": "),a=n.shift(),p=n.join(": ");return[a,p]}).filter(o=>o[0].length>0),r=new Map(e);return{status:t.status,content:t.response,contentType:L(r,"content-type",o=>o),contentLength:L(r,"content-length",parseFloat),fileName:L(r,"content-disposition",o=>{if(h(o)){let n=o.match(At);if(h(n))return n[1]}return null}),date:L(r,"date",o=>new Date(o)),headers:r}}var K=class extends V{constructor(){super(...arguments);i(this,"defaultPostHeaders",new Map)}setRequestVerificationToken(e){this.defaultPostHeaders.set("RequestVerificationToken",e)}async headOrGetXHR(e,r,s,o){let n=new XMLHttpRequest,a=G(`requesting: ${s.path}`,n,n,o,!0);return gt(n,r,e,s.path,s.timeout,s.headers),await a,xt(n)}getXHR(e,r,s){return this.headOrGetXHR("GET",e,r,s)}head(e){return this.headOrGetXHR("HEAD","",e,null)}async postXHR(e,r,s){let o=null,n=rt(new Map,this.defaultPostHeaders,r.headers);if(r.body instanceof FormData&&h(n)){let v=new Array;for(let m of n.keys())m.toLowerCase()==="content-type"&&v.push(m);for(let m of v)n.delete(m)}Z(r.body)&&!T(r.body)?o=r.body:h(r.body)&&(o=JSON.stringify(r.body));let a=ut(s),p=new XMLHttpRequest,u=h(o)?G("uploading",p,p.upload,a.pop(),!1):Promise.resolve(),l=G("saving",p,p,a.pop(),!0,u);return gt(p,e,"POST",r.path,r.timeout,n,o),await u,await l,xt(p)}getBlob(e,r){return this.getXHR("blob",e,r)}postObjectForBlob(e,r){return this.postXHR("blob",e,r)}getBuffer(e,r){return this.getXHR("arraybuffer",e,r)}postObjectForBuffer(e,r){return this.postXHR("arraybuffer",e,r)}getText(e,r){return this.getXHR("text",e,r)}postObjectForText(e,r){return this.postXHR("text",e,r)}async getObject(e,r){return(await this.getXHR("json",e,r)).content}async postObjectForObject(e,r){return(await this.postXHR("json",e,r)).content}postObject(e,r){return this.postXHR("",e,r)}getFile(e,r){return this.translateResponse(this.getBlob(e,r),URL.createObjectURL)}postObjectForFile(e,r){return this.translateResponse(this.postObjectForBlob(e,r),URL.createObjectURL)}getXml(e,r){return this.translateResponse(this.getXHR("document",e,r),s=>s.documentElement)}postObjectForXml(e,r){return this.translateResponse(this.postXHR("document",e,r),s=>s.documentElement)}getImageBitmap(e,r){return this.translateResponse(this.getBlob(e,r),createImageBitmap)}async postObjectForImageBitmap(e,r){return this.translateResponse(this.postObjectForBlob(e,r),createImageBitmap)}};var J=class extends j{constructor(e){super(e);let r=new K;Bt(this,r)}};function z(t){return[t.content]}function Bt(t,e){t.addVoidMethod("setRequestVerificationToken",e,e.setRequestVerificationToken),t.addMethod("getBuffer",e,e.getBuffer,z),t.addMethod("postObjectForBuffer",e,e.postObjectForBuffer,z),t.addMethod("getImageBitmap",e,e.getImageBitmap,z),t.addMethod("postObjectForImageBitmap",e,e.postObjectForImageBitmap,z),t.addMethod("getObject",e,e.getObject),t.addMethod("getFile",e,e.getFile),t.addMethod("getText",e,e.getText),t.addMethod("postObject",e,e.postObject),t.addMethod("postObjectForObject",e,e.postObjectForObject),t.addMethod("postObjectForFile",e,e.postObjectForFile),t.addMethod("postObjectForText",e,e.postObjectForText),t.addMethod("head",e,e.head)}globalThis.server=new J(globalThis);
//# sourceMappingURL=index.min.js.map
