var gt=Object.defineProperty;var xt=(e,t,r)=>t in e?gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var i=(e,t,r)=>(xt(e,typeof t!="symbol"?t+"":t,r),r);function k(e,t,r){return typeof e===t||e instanceof r}function g(e){return k(e,"function",Function)}function F(e){return k(e,"string",String)}function W(e){return k(e,"boolean",Boolean)}function _(e){return k(e,"number",Number)}function x(e){return e instanceof Array}function H(e,t){throw new Error((t||"Unexpected object: ")+e)}function m(e){return e==null}function h(e){return!m(e)}function yt(e){return e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Uint32Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||"BigUint64Array"in globalThis&&e instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&e instanceof globalThis.BigInt64Array}function wt(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Q(e){return F(e)||yt(e)||e instanceof Blob||e instanceof FormData||wt(e)||e instanceof ReadableStream||"Document"in globalThis&&e instanceof Document}function E(e,t){return e.splice(t,1)[0]}function w(e){return e.splice(0)}var Z=new WeakMap,Y=class{constructor(){i(this,"listeners",new Map);i(this,"listenerOptions",new Map);Z.set(this,this.listeners)}addEventListener(t,r,s){if(g(r)){let o=this.listeners.get(t);o||(o=new Array,this.listeners.set(t,o)),o.find(n=>n===r)||(o.push(r),s&&this.listenerOptions.set(r,s))}}removeEventListener(t,r){if(g(r)){let s=this.listeners.get(t);s&&this.removeListener(s,r)}}removeListener(t,r){let s=t.findIndex(o=>o===r);s>=0&&(E(t,s),this.listenerOptions.has(r)&&this.listenerOptions.delete(r))}dispatchEvent(t){let r=this.listeners.get(t.type);if(r)for(let s of r){let o=this.listenerOptions.get(s);h(o)&&!W(o)&&o.once&&this.removeListener(r,s),s.call(this,t)}return!t.defaultPrevented}},b=class extends Event{get type(){return super.type}constructor(t){super(t)}},v=class extends Y{constructor(){super(...arguments);i(this,"bubblers",new Set);i(this,"scopes",new WeakMap)}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addEventListener(t,r,s){super.addEventListener(t,r,s)}removeEventListener(t,r){super.removeEventListener(t,r)}addScopedEventListener(t,r,s,o){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([r,s]),this.addEventListener(r,s,o)}removeScope(t){let r=this.scopes.get(t);if(r){this.scopes.delete(t);for(let[s,o]of r)this.removeEventListener(s,o)}}clearEventListeners(t){let r=Z.get(this);for(let[s,o]of r)(m(t)||t===s)&&(w(o),r.delete(s))}dispatchEvent(t){if(!super.dispatchEvent(t))return!1;for(let r of this.bubblers)if(!r.dispatchEvent(t))return!1;return!0}};function et(e,...t){for(let r of t)if(h(r))for(let[s,o]of r)e.set(s,o);return e}var $;(function(e){e[e.LocalUser=0]="LocalUser",e[e.Mouse=1]="Mouse",e[e.Pen=2]="Pen",e[e.Touch0=3]="Touch0",e[e.Touch1=4]="Touch1",e[e.Touch2=5]="Touch2",e[e.Touch3=6]="Touch3",e[e.Touch4=7]="Touch4",e[e.Touch5=8]="Touch5",e[e.Touch6=9]="Touch6",e[e.Touch7=10]="Touch7",e[e.Touch8=11]="Touch8",e[e.Touch9=12]="Touch9",e[e.Touch10=13]="Touch10",e[e.Touches=14]="Touches",e[e.MotionController=15]="MotionController",e[e.MotionControllerLeft=16]="MotionControllerLeft",e[e.MotionControllerRight=17]="MotionControllerRight",e[e.RemoteUser=18]="RemoteUser"})($||($={}));var rt;(function(e){e[e.Forward=1]="Forward",e[e.Stopped=0]="Stopped",e[e.Reverse=-1]="Reverse"})(rt||(rt={}));var st;(function(e){e.None="",e.Left="left",e.Right="right"})(st||(st={}));var ot;(function(e){e.None="none",e.Entered="entered",e.EnteredDisabled="entereddisabled",e.Pressed="pressed",e.PressedDisabled="presseddisabled",e.Clicked="clicked",e.ClickedDisabled="clickeddisabled",e.DraggingStarted="draggingstarted",e.DraggingStartedDisabled="draggingstarteddisabled",e.Dragged="dragged",e.DraggingEnded="draggingended",e.Released="released",e.Exited="exited",e.Opened="opened",e.Closed="closed",e.Error="error",e.Success="success",e.StartUp="startup",e.ShutDown="shutdown",e.Scrolled="scrolled"})(ot||(ot={}));var nt;(function(e){e[e.Mouse0=0]="Mouse0",e[e.Mouse1=1]="Mouse1",e[e.Mouse2=2]="Mouse2",e[e.Mouse3=3]="Mouse3",e[e.Mouse4=4]="Mouse4"})(nt||(nt={}));var it;(function(e){e[e.None=0]="None",e[e.Mouse0=1]="Mouse0",e[e.Mouse1=2]="Mouse1",e[e.Mouse2=4]="Mouse2",e[e.Mouse3=8]="Mouse3",e[e.Mouse4=16]="Mouse4"})(it||(it={}));var at;(function(e){e[e.None=0]="None",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary",e[e.Menu=3]="Menu",e[e.Info=4]="Info"})(at||(at={}));var St=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,A=navigator.userAgent.match(St),R=!!A,kr=R&&{major:parseFloat(A[1]),minor:parseFloat(A[2]),patch:parseFloat(A[3])},Fr=R&&/pacific/i.test(navigator.userAgent),_r=R&&/quest/i.test(navigator.userAgent),Er=R&&/quest 2/i.test(navigator.userAgent);var Ar=!("Document"in globalThis);var kt=298.257223563,Ft=6378137;var j=1/kt,P=1-j,c=j/(2-j),Pr=Ft/(1+c)*(1+c*c/4+c*c*c*c/64),C=Math.sqrt(1-P*P),f=1-P*P,Cr=C*C/(1-C*C),Or=1-f*(.25+f*(3/64+5*f/256)),Br=f*(3/8+f*(3/32+45*f/1024)),Dr=f*f*(15/256+f*45/1024),Ir=f*f*f*(35/3072),zr=[c/2-2*c*c/3+37*c*c*c/96,c*c/48+c*c*c/15,17*c*c*c/480],Lr=[2*c-2*c*c/3,7*c*c/3-8*c*c*c/5,56*c*c*c/15];var X;(function(e){e[e.Northern=0]="Northern",e[e.Southern=1]="Southern"})(X||(X={}));var Ls=2*Math.PI;var M=class{constructor(){i(this,"attached",new Array);i(this,"soFar",null);i(this,"total",null);i(this,"msg",null);i(this,"est",null)}report(t,r,s,o){this.soFar=t,this.total=r,this.msg=s,this.est=o;for(let n of this.attached)n.report(t,r,s,o)}attach(t){this.attached.push(t),t.report(this.soFar,this.total,this.msg,this.est)}end(){this.report(1,1,"done"),this.soFar=null,this.total=null,this.msg=null,this.est=null,w(this.attached)}};var O=class extends M{constructor(t,r){super();i(this,"i");i(this,"prog");this.i=t,this.prog=r}report(t,r,s,o){super.report(t,r,s,o),this.prog.update(this.i,t,r,s)}};var B=class{constructor(t){i(this,"prog");i(this,"weightTotal",0);i(this,"start");i(this,"subProgressCallbacks",new Array);i(this,"subProgressWeights",new Array);i(this,"subProgressValues",new Array);this.prog=t,this.start=performance.now();for(let r=0;r<this.subProgressWeights.length;++r)this.subProgressValues[r]=0,this.subProgressCallbacks[r]=new O(r,this)}addSubProgress(t){t=t||1,this.weightTotal+=t,this.subProgressWeights.push(t),this.subProgressValues.push(0);let r=new O(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(r),r}update(t,r,s,o){if(this.prog){this.subProgressValues[t]=r/s;let n=0;for(let l=0;l<this.subProgressWeights.length;++l)n+=this.subProgressValues[l]*this.subProgressWeights[l];let a=performance.now(),p=a-this.start,u=this.start-a+p*this.weightTotal/n;this.prog.report(n,this.weightTotal,o,u)}}};function T(e){return h(e)&&g(e.report)&&g(e.attach)&&g(e.end)}function ct(e){return new pt(e)}var pt=class extends B{pop(t){return this.addSubProgress(t)}};var I=class extends v{constructor(t){super();i(this,"worker");i(this,"taskCounter",0);i(this,"invocations",new Map);this.worker=t,I.isSupported||console.warn("Workers are not supported on this system."),this.worker.addEventListener("message",r=>{let s=r.data;switch(s.type){case"event":this.propogateEvent(s);break;case"progress":this.progressReport(s);break;case"return":this.methodReturned(s);break;case"error":this.invocationError(s);break;default:H(s)}})}postMessage(t,r){t.type!=="methodCall"&&H(t.type),r?this.worker.postMessage(t,r):this.worker.postMessage(t)}dispose(){this.worker.terminate()}propogateEvent(t){let r=new b(t.eventName);this.dispatchEvent(Object.assign(r,t.data))}progressReport(t){let r=this.invocations.get(t.taskID),{onProgress:s}=r;s&&s.report(t.soFar,t.total,t.msg,t.est)}methodReturned(t){let r=this.removeInvocation(t.taskID),{resolve:s}=r;s(t.returnValue)}invocationError(t){let r=this.removeInvocation(t.taskID),{reject:s,methodName:o}=r;s(new Error(`${o} failed. Reason: ${t.errorMessage}`))}removeInvocation(t){let r=this.invocations.get(t);return this.invocations.delete(t),r}callMethod(t,r,s,o){if(!I.isSupported)return Promise.reject(new Error("Workers are not supported on this system."));let n=null,a=null;T(r)&&(o=r,r=null,s=null),T(s)&&!o&&(o=s,s=null),x(r)&&(n=r),x(s)&&(a=s);let p=this.taskCounter++;return new Promise((u,l)=>{let y={onProgress:o,resolve:u,reject:l,methodName:t};this.invocations.set(p,y);let d=null;h(r)?d={type:"methodCall",taskID:p,methodName:t,params:n}:d={type:"methodCall",taskID:p,methodName:t},this.postMessage(d,a)})}},D=I;i(D,"isSupported","Worker"in globalThis);var lt=class extends v{constructor(t,r){super();i(this,"scriptPath");i(this,"taskCounter");i(this,"workers");this.scriptPath=t.scriptPath;let s=-1,o=t.workers,n=null;if(_(o)?s=o:h(o)?(this.taskCounter=o.curTaskCounter,n=o.workers,s=n.length):s=navigator.hardwareConcurrency||4,s<1)throw new Error("Worker pool size must be a postive integer greater than 0");if(this.workers=new Array(s),m(n)){this.taskCounter=0;for(let a=0;a<s;++a)this.workers[a]=new r(new Worker(this.scriptPath,{type:"module"}))}else for(let a=0;a<s;++a)this.workers[a]=new r(n[a]);for(let a of this.workers)a.addBubbler(this)}dispose(){for(let t of this.workers)t.dispose();w(this.workers)}callMethod(t,r,s,o){if(!D.isSupported)return Promise.reject(new Error("Workers are not supported on this system."));let n=null,a=null;return T(r)&&(o=r,r=null,s=null),T(s)&&!o&&(o=s,s=null),x(r)&&(n=r),x(s)&&(a=s),this.nextWorker().callMethod(t,n,a,o)}nextWorker(){let r=this.taskCounter++%this.workers.length;return this.workers[r]}};i(lt,"isSupported","Worker"in globalThis);var ft=class extends M{constructor(t,r){super();i(this,"server");i(this,"taskID");this.server=t,this.taskID=r}report(t,r,s,o){let n={type:"progress",taskID:this.taskID,soFar:t,total:r,msg:s,est:o};this.server.postMessage(n)}},V=class{constructor(t){i(this,"self");i(this,"methods",new Map);this.self=t,this.self.addEventListener("message",r=>{let s=r.data;this.callMethod(s)})}postMessage(t,r){h(r)?this.self.postMessage(t,r):this.self.postMessage(t)}callMethod(t){let r=this.methods.get(t.methodName);if(r)try{x(t.params)?r(t.taskID,...t.params):h(t.params)?r(t.taskID,t.params):r(t.taskID)}catch(s){this.onError(t.taskID,`method invocation error: ${t.methodName}(${s.message||s})`)}else this.onError(t.taskID,`method not found: ${t.methodName}`)}onError(t,r){let s={type:"error",taskID:t,errorMessage:r};this.postMessage(s)}onReturn(t,r,s){let o=null;if(r===void 0?o={type:"return",taskID:t}:o={type:"return",taskID:t,returnValue:r},h(s)){let n=s(r);this.postMessage(o,n)}else this.postMessage(o)}onEvent(t,r,s,o){let n=null;if(h(s)?n={type:"event",eventName:t,data:s(r)}:n={type:"event",eventName:t},n.data!==void 0&&h(o)){let a=o(n.data);this.postMessage(n,a)}else this.postMessage(n)}addMethodInternal(t,r,s){if(this.methods.has(t))throw new Error(`${t} method has already been mapped.`);this.methods.set(t,async(o,...n)=>{let a=new ft(this,o);try{let p=await r(...n,a);this.onReturn(o,p,s)}catch(p){console.error(p),this.onError(o,p.message||p)}})}addFunction(t,r,s){this.addMethodInternal(t,r,s)}addVoidFunction(t,r){this.addMethodInternal(t,r)}addMethod(t,r,s,o){this.addFunction(t,s.bind(r),o)}addVoidMethod(t,r,s){this.addVoidFunction(t,s.bind(r))}addEvent(t,r,s,o){t.addEventListener(r,n=>this.onEvent(r,n,s,o))}};var G=class{async translateResponse(t,r){let{status:s,content:o,contentType:n,contentLength:a,fileName:p,headers:u,date:l}=await t;return{status:s,content:await r(o),contentType:n,contentLength:a,fileName:p,headers:u,date:l}}};function q(e,t,r,s,o,n){return new Promise((a,p)=>{let u=!n;n&&n.then(()=>u=!0);let l=!1,y=o;function d(){y&&l&&a()}function N(U){return()=>{u&&p(`${U} (${t.status})`)}}r.addEventListener("loadstart",()=>{u&&!l&&s&&s.report(0,1,e)}),r.addEventListener("progress",U=>{if(u&&!l){let S=U;s&&s.report(S.loaded,Math.max(S.loaded,S.total),e),S.loaded===S.total&&(y=!0,d())}}),r.addEventListener("load",()=>{u&&!l&&(s&&s.report(1,1,e),l=!0,d())}),r.addEventListener("error",N("error")),r.addEventListener("abort",N("abort")),r.addEventListener("timeout",N("timeout"))})}function dt(e,t,r,s,o,n,a){if(e.open(r,s),e.responseType=t,e.timeout=o,n)for(let[p,u]of n)e.setRequestHeader(p,u);h(a)?e.send(a):e.send()}function z(e,t,r){if(!e.has(t))return null;let s=e.get(t);try{let o=r(s);return e.delete(t),o}catch(o){console.warn(t,o)}return null}var Rt=/filename=\"(.+)\"(;|$)/;function mt(e){let t=e.getAllResponseHeaders().split(/[\r\n]+/).map(o=>{let n=o.split(": "),a=n.shift(),p=n.join(": ");return[a,p]}).filter(o=>o[0].length>0),r=new Map(t);return{status:e.status,content:e.response,contentType:z(r,"content-type",o=>o),contentLength:z(r,"content-length",parseFloat),fileName:z(r,"content-disposition",o=>{if(h(o)){let n=o.match(Rt);if(h(n))return n[1]}return null}),date:z(r,"date",o=>new Date(o)),headers:r}}var K=class extends G{constructor(){super(...arguments);i(this,"defaultPostHeaders",new Map)}setRequestVerificationToken(t){this.defaultPostHeaders.set("RequestVerificationToken",t)}async headOrGetXHR(t,r,s,o){let n=new XMLHttpRequest,a=q(`requesting: ${s.path}`,n,n,o,!0);return dt(n,r,t,s.path,s.timeout,s.headers),await a,mt(n)}getXHR(t,r,s){return this.headOrGetXHR("GET",t,r,s)}head(t){return this.headOrGetXHR("HEAD","",t,null)}async postXHR(t,r,s){let o=null,n=et(new Map,this.defaultPostHeaders,r.headers);if(r.body instanceof FormData&&h(n)){let y=new Array;for(let d of n.keys())d.toLowerCase()==="content-type"&&y.push(d);for(let d of y)n.delete(d)}Q(r.body)&&!F(r.body)?o=r.body:h(r.body)&&(o=JSON.stringify(r.body));let a=ct(s),p=new XMLHttpRequest,u=h(o)?q("uploading",p,p.upload,a.pop(),!1):Promise.resolve(),l=q("saving",p,p,a.pop(),!0,u);return dt(p,t,"POST",r.path,r.timeout,n,o),await u,await l,mt(p)}getBlob(t,r){return this.getXHR("blob",t,r)}postObjectForBlob(t,r){return this.postXHR("blob",t,r)}getBuffer(t,r){return this.getXHR("arraybuffer",t,r)}postObjectForBuffer(t,r){return this.postXHR("arraybuffer",t,r)}getText(t,r){return this.getXHR("text",t,r)}postObjectForText(t,r){return this.postXHR("text",t,r)}async getObject(t,r){return(await this.getXHR("json",t,r)).content}async postObjectForObject(t,r){return(await this.postXHR("json",t,r)).content}postObject(t,r){return this.postXHR("",t,r)}getFile(t,r){return this.translateResponse(this.getBlob(t,r),URL.createObjectURL)}postObjectForFile(t,r){return this.translateResponse(this.postObjectForBlob(t,r),URL.createObjectURL)}getXml(t,r){return this.translateResponse(this.getXHR("document",t,r),s=>s.documentElement)}postObjectForXml(t,r){return this.translateResponse(this.postXHR("document",t,r),s=>s.documentElement)}getImageBitmap(t,r){return this.translateResponse(this.getBlob(t,r),createImageBitmap)}async postObjectForImageBitmap(t,r){return this.translateResponse(this.postObjectForBlob(t,r),createImageBitmap)}};var J=class extends V{constructor(t){super(t);let r=new K;Pt(this,r)}};function L(e){return[e.content]}function Pt(e,t){e.addVoidMethod("setRequestVerificationToken",t,t.setRequestVerificationToken),e.addMethod("getBuffer",t,t.getBuffer,L),e.addMethod("postObjectForBuffer",t,t.postObjectForBuffer,L),e.addMethod("getImageBitmap",t,t.getImageBitmap,L),e.addMethod("postObjectForImageBitmap",t,t.postObjectForImageBitmap,L),e.addMethod("getObject",t,t.getObject),e.addMethod("getFile",t,t.getFile),e.addMethod("getText",t,t.getText),e.addMethod("postObject",t,t.postObject),e.addMethod("postObjectForObject",t,t.postObjectForObject),e.addMethod("postObjectForFile",t,t.postObjectForFile),e.addMethod("postObjectForText",t,t.postObjectForText),e.addMethod("head",t,t.head)}globalThis.server=new J(globalThis);
//# sourceMappingURL=index.min.js.map
